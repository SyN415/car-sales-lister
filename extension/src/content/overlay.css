/* ================================================================
   Car Sales Lister â€“ Marketplace Overlay
   Glassmorphism-styled badges, panels, and deal indicators
   ================================================================ */

/* ----- Reset & Namespace ----- */
.csl-overlay, .csl-overlay * {
  box-sizing: border-box;
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
  line-height: 1.4;
  -webkit-font-smoothing: antialiased;
}

/* ----- Deal Badge (feed/search cards) ----- */
.csl-badge {
  position: absolute;
  top: 8px;
  right: 8px;
  z-index: 9999;
  display: flex;
  align-items: center;
  gap: 5px;
  padding: 5px 10px;
  border-radius: 8px;
  font-size: 11px;
  font-weight: 700;
  letter-spacing: 0.3px;
  backdrop-filter: blur(12px);
  -webkit-backdrop-filter: blur(12px);
  border: 1px solid rgba(255,255,255,0.15);
  box-shadow: 0 4px 16px rgba(0,0,0,0.25);
  cursor: pointer;
  transition: transform 0.15s ease, box-shadow 0.15s ease;
  pointer-events: auto;
}
.csl-badge:hover {
  transform: translateY(-1px);
  box-shadow: 0 6px 20px rgba(0,0,0,0.35);
}
.csl-badge-icon { font-size: 13px; }
.csl-badge-text { white-space: nowrap; }
.csl-badge-price { font-size: 10px; opacity: 0.85; white-space: nowrap; }

/* Deal tiers */
.csl-badge--great { background: rgba(16,185,129,0.85); color: #fff; }
.csl-badge--good  { background: rgba(245,158,11,0.85); color: #fff; }
.csl-badge--fair  { background: rgba(249,115,22,0.85); color: #fff; }
.csl-badge--over  { background: rgba(239,68,68,0.85); color: #fff; }
.csl-badge--unknown { background: rgba(100,116,139,0.8); color: #fff; }
.csl-badge--login { background: rgba(37,99,235,0.85); color: #fff; }

/* ----- Detail Panel (floating sidebar) ----- */
.csl-panel {
  position: fixed;
  bottom: 20px;
  right: 20px;
  z-index: 99999;
  width: 320px;
  border-radius: 16px;
  background: rgba(15,23,42,0.92);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255,255,255,0.1);
  box-shadow: 0 8px 32px rgba(0,0,0,0.4);
  color: #e2e8f0;
  overflow: hidden;
  transition: transform 0.25s cubic-bezier(0.4,0,0.2,1), opacity 0.25s ease;
  animation: csl-slide-up 0.3s cubic-bezier(0.4,0,0.2,1);
}
@keyframes csl-slide-up {
  from { transform: translateY(20px); opacity: 0; }
  to   { transform: translateY(0); opacity: 1; }
}

.csl-panel--collapsed { transform: translateY(calc(100% - 44px)); }

.csl-panel-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 10px 14px;
  background: rgba(255,255,255,0.05);
  border-bottom: 1px solid rgba(255,255,255,0.08);
  cursor: pointer;
  user-select: none;
}
.csl-panel-title {
  display: flex;
  align-items: center;
  gap: 6px;
  font-size: 13px;
  font-weight: 700;
  color: #f1f5f9;
}
.csl-panel-close {
  background: none;
  border: none;
  color: #94a3b8;
  font-size: 18px;
  cursor: pointer;
  padding: 0 2px;
  line-height: 1;
}
.csl-panel-close:hover { color: #f1f5f9; }

.csl-panel-body { padding: 14px; }

/* Vehicle Info */
.csl-vehicle-name {
  font-size: 15px;
  font-weight: 600;
  color: #f8fafc;
  margin-bottom: 4px;
}
.csl-vehicle-meta {
  font-size: 11px;
  color: #94a3b8;
  margin-bottom: 12px;
}

/* Price Comparison */
.csl-price-row {
  display: flex;
  justify-content: space-between;
  align-items: baseline;
  padding: 6px 0;
  font-size: 13px;
}
.csl-price-label { color: #94a3b8; }
.csl-price-value { font-weight: 700; }
.csl-price-asking { color: #f8fafc; font-size: 18px; }
.csl-price-market { color: #10b981; font-size: 16px; }
.csl-price-range  { color: #64748b; font-size: 11px; }

.csl-divider {
  border: none;
  border-top: 1px solid rgba(255,255,255,0.08);
  margin: 10px 0;
}

/* Deal Score Bar */
.csl-score-section { margin: 8px 0; }
.csl-score-bar-track {
  width: 100%;
  height: 8px;
  background: rgba(255,255,255,0.1);
  border-radius: 4px;
  overflow: hidden;
  margin-bottom: 6px;
}

/* Score colors */
.csl-score-bar-fill--great, .csl-score-tag--great { background: #10b981; color: #fff; }
.csl-score-bar-fill--good,  .csl-score-tag--good  { background: #f59e0b; color: #fff; }
.csl-score-bar-fill--fair,  .csl-score-tag--fair   { background: #f97316; color: #fff; }
.csl-score-bar-fill--over,  .csl-score-tag--over   { background: #ef4444; color: #fff; }

/* Savings indicator */
.csl-savings {
  display: flex;
  align-items: center;
  gap: 6px;
  padding: 8px 10px;
  border-radius: 8px;
  font-size: 12px;
  font-weight: 600;
  margin: 8px 0;
}
.csl-savings--positive { background: rgba(16,185,129,0.15); color: #34d399; }
.csl-savings--negative { background: rgba(239,68,68,0.15); color: #f87171; }

/* Action Buttons */
.csl-actions { display: flex; gap: 8px; margin-top: 12px; }

.csl-btn {
  flex: 1;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 5px;
  padding: 8px 12px;
  border: none;
  border-radius: 8px;
  font-size: 12px;
  font-weight: 600;
  cursor: pointer;
  transition: background 0.15s ease, transform 0.1s ease;
}
.csl-btn:active { transform: scale(0.97); }

.csl-btn--primary {
  background: #10b981;
  color: #fff;
}
.csl-btn--primary:hover { background: #059669; }
.csl-btn--primary.csl-btn--added {
  background: rgba(16,185,129,0.2);
  color: #34d399;
  cursor: default;
}

.csl-btn--secondary {
  background: rgba(255,255,255,0.08);
  color: #cbd5e1;
  border: 1px solid rgba(255,255,255,0.1);
}
.csl-btn--secondary:hover { background: rgba(255,255,255,0.14); }

/* Login prompt inside panel */
.csl-login-prompt {
  text-align: center;
  padding: 16px 10px;
}
.csl-login-prompt p {
  font-size: 12px;
  color: #94a3b8;
  margin-bottom: 10px;
}

/* Tooltip on badge hover */
.csl-badge-tooltip {
  position: absolute;
  top: calc(100% + 6px);
  right: 0;
  min-width: 180px;
  padding: 8px 10px;
  border-radius: 8px;
  background: rgba(15,23,42,0.95);
  backdrop-filter: blur(12px);
  border: 1px solid rgba(255,255,255,0.1);
  box-shadow: 0 4px 16px rgba(0,0,0,0.3);
  font-size: 11px;
  color: #e2e8f0;
  opacity: 0;
  pointer-events: none;
  transition: opacity 0.15s ease;
  z-index: 10000;
}
.csl-badge:hover .csl-badge-tooltip { opacity: 1; pointer-events: auto; }
.csl-badge-tooltip-row {
  display: flex;
  justify-content: space-between;
  padding: 2px 0;
}

/* Loading spinner */
.csl-spinner {
  display: inline-block;
  width: 14px;
  height: 14px;
  border: 2px solid rgba(255,255,255,0.3);
  border-top-color: #fff;
  border-radius: 50%;
  animation: csl-spin 0.6s linear infinite;
}
@keyframes csl-spin {
  to { transform: rotate(360deg); }
}

/* Responsive: Hide panel on very small viewports */
@media (max-width: 480px) {
  .csl-panel { width: calc(100vw - 20px); right: 10px; bottom: 10px; }
}
.csl-score-bar-fill {
  height: 100%;
  border-radius: 4px;
  transition: width 0.6s cubic-bezier(0.4,0,0.2,1);
}
.csl-score-label {
  display: flex;
  justify-content: space-between;
  align-items: center;
  font-size: 12px;
}
.csl-score-tag {
  padding: 2px 8px;
  border-radius: 4px;
  font-weight: 700;
  font-size: 11px;
  letter-spacing: 0.3px;
}

/* ----- Quick Action Links Grid ----- */
.csl-quick-actions {
  display: flex;
  flex-wrap: wrap;
  gap: 6px;
  margin: 10px 0;
}
.csl-action-link {
  display: inline-flex;
  align-items: center;
  gap: 4px;
  padding: 5px 10px;
  border-radius: 6px;
  font-size: 11px;
  font-weight: 600;
  color: #94a3b8;
  background: rgba(255,255,255,0.06);
  border: 1px solid rgba(255,255,255,0.08);
  text-decoration: none;
  cursor: pointer;
  transition: background 0.15s ease, color 0.15s ease, border-color 0.15s ease;
  white-space: nowrap;
}
.csl-action-link:hover {
  background: rgba(255,255,255,0.12);
  color: #e2e8f0;
  border-color: rgba(255,255,255,0.18);
}
.csl-action-link--success {
  color: #34d399 !important;
  border-color: rgba(16,185,129,0.3) !important;
  background: rgba(16,185,129,0.1) !important;
}
.csl-action-icon { font-size: 12px; }

/* ----- Inline links (e.g. market value link) ----- */
.csl-link--inline {
  color: #10b981;
  text-decoration: none;
  border-bottom: 1px dashed rgba(16,185,129,0.4);
  transition: color 0.15s ease, border-color 0.15s ease;
}
.csl-link--inline:hover {
  color: #34d399;
  border-bottom-color: #34d399;
}

/* ----- Expandable Sections ----- */
.csl-expandable {
  margin: 8px 0;
  border-radius: 8px;
  border: 1px solid rgba(255,255,255,0.06);
  overflow: hidden;
  transition: border-color 0.2s ease;
}
.csl-expandable:hover {
  border-color: rgba(255,255,255,0.12);
}
.csl-expandable-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 8px 12px;
  font-size: 12px;
  font-weight: 600;
  color: #cbd5e1;
  cursor: pointer;
  background: rgba(255,255,255,0.03);
  user-select: none;
  transition: background 0.15s ease;
}
.csl-expandable-header:hover {
  background: rgba(255,255,255,0.06);
}
.csl-chevron {
  font-size: 14px;
  font-weight: 700;
  color: #64748b;
  transition: transform 0.2s ease;
}
.csl-expandable--open .csl-chevron {
  transform: rotate(90deg);
}
.csl-expandable-content {
  max-height: 0;
  overflow: hidden;
  padding: 0 12px;
  transition: max-height 0.3s cubic-bezier(0.4,0,0.2,1), padding 0.3s ease;
}
.csl-expandable--open .csl-expandable-content {
  max-height: 400px;
  padding: 10px 12px;
}

/* ----- Fair Offer Box ----- */
.csl-offer-box {
  display: flex;
  align-items: baseline;
  justify-content: space-between;
  padding: 10px 12px;
  border-radius: 8px;
  background: rgba(16,185,129,0.1);
  border: 1px solid rgba(16,185,129,0.2);
  margin-bottom: 8px;
}
.csl-offer-label {
  font-size: 11px;
  color: #94a3b8;
  font-weight: 500;
}
.csl-offer-value {
  font-size: 20px;
  font-weight: 800;
  color: #34d399;
  letter-spacing: -0.5px;
}
.csl-offer-savings {
  font-size: 11px;
  color: #10b981;
  margin-top: 4px;
}

/* ----- Cost of Ownership ----- */
.csl-cost-row {
  display: flex;
  justify-content: space-between;
  padding: 4px 0;
  font-size: 11px;
  color: #94a3b8;
  border-bottom: 1px solid rgba(255,255,255,0.04);
}
.csl-cost-row:last-of-type {
  border-bottom: none;
}
.csl-cost-total {
  font-weight: 700;
  color: #e2e8f0;
  padding-top: 6px;
  margin-top: 4px;
  border-top: 1px solid rgba(255,255,255,0.1);
  border-bottom: none;
}

/* ----- VIN Section ----- */
.csl-vin-display {
  font-size: 11px;
  color: #94a3b8;
  margin-bottom: 8px;
}
.csl-vin-display code {
  font-family: 'JetBrains Mono', 'Fira Code', monospace;
  font-size: 11px;
  background: rgba(255,255,255,0.08);
  padding: 2px 6px;
  border-radius: 4px;
  color: #e2e8f0;
  letter-spacing: 0.5px;
}
.csl-vin-links {
  display: flex;
  flex-direction: column;
  gap: 4px;
}
.csl-vin-links .csl-link {
  font-size: 11px;
  color: #60a5fa;
  text-decoration: none;
  transition: color 0.15s ease;
}
.csl-vin-links .csl-link:hover {
  color: #93bbfc;
  text-decoration: underline;
}

/* ----- Hint Text ----- */
.csl-hint {
  font-size: 10px;
  color: #64748b;
  margin-top: 6px;
  line-height: 1.4;
}

/* ----- Panel scroll for long content ----- */
.csl-panel-body {
  max-height: 70vh;
  overflow-y: auto;
  scrollbar-width: thin;
  scrollbar-color: rgba(255,255,255,0.15) transparent;
}
.csl-panel-body::-webkit-scrollbar {
  width: 4px;
}
.csl-panel-body::-webkit-scrollbar-track {
  background: transparent;
}
.csl-panel-body::-webkit-scrollbar-thumb {
  background: rgba(255,255,255,0.15);
  border-radius: 2px;
}


/* ---- Factorness Badge Pills ---- */
.csl-factor-badges {
  display: flex;
  flex-wrap: wrap;
  gap: 4px;
  margin: 6px 0 4px;
}
.csl-factor-pill {
  display: inline-flex;
  align-items: center;
  gap: 3px;
  padding: 2px 8px;
  border-radius: 12px;
  font-size: 11px;
  font-weight: 600;
  line-height: 1.4;
}
.csl-factor--positive { background: rgba(16,185,129,0.18); color: #6ee7b7; }
.csl-factor--negative { background: rgba(239,68,68,0.18); color: #fca5a5; }
.csl-factor--neutral  { background: rgba(148,163,184,0.15); color: #94a3b8; }

/* ---- Repair Estimate severity dots ---- */
.csl-severity-dot {
  display: inline-block;
  width: 8px;
  height: 8px;
  border-radius: 50%;
  margin-right: 6px;
  vertical-align: middle;
}
.csl-severity--minor    { background: #f59e0b; }
.csl-severity--moderate { background: #f97316; }
.csl-severity--major    { background: #ef4444; }

/* ---- Resellability line ---- */
.csl-resellability {
  margin: 8px 0;
  padding: 6px 10px;
  border-radius: 6px;
  background: rgba(16,185,129,0.08);
  font-size: 12px;
  color: #94a3b8;
}
.csl-comp-count {
  opacity: 0.6;
  font-size: 11px;
  margin-left: 4px;
}

/* ---- Flip Analysis block ---- */
.csl-flip-analysis {
  margin: 10px 0;
  padding: 10px 12px;
  border-radius: 8px;
  background: rgba(255,255,255,0.04);
  border: 1px solid rgba(255,255,255,0.08);
}
.csl-flip-title {
  font-weight: 700;
  font-size: 13px;
  margin-bottom: 6px;
}
.csl-flip-divider {
  border-top: 1px dashed rgba(255,255,255,0.1);
  margin: 6px 0;
}
.csl-flip-row {
  display: flex;
  justify-content: space-between;
  font-size: 12px;
  padding: 2px 0;
  color: #cbd5e1;
}
.csl-flip-row--profit { color: #6ee7b7; font-weight: 700; }
.csl-flip-row--loss   { color: #fca5a5; font-weight: 700; }
.csl-flip-score {
  font-weight: 700;
  font-size: 13px;
  color: #60a5fa;
}